<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edificio-Admin | Panel de Administrador</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="/css/file-upload.css">
</head>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar" class="bg-dark text-white">
            <div class="sidebar-header p-3">
                <h3 class="fs-5">Edificio-Admin</h3>
                <p class="small mb-0">Panel de Administrador</p>
            </div>

            <ul class="list-unstyled components">
                <li class="active">
                    <a href="#" class="nav-link text-white" data-section="dashboard">
                        <i class="bi bi-speedometer2 me-2"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="usuarios">
                        <i class="bi bi-people me-2"></i> Usuarios
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="cuotas">
                        <i class="bi bi-cash-coin me-2"></i> Cuotas
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="gastos">
                        <i class="bi bi-credit-card me-2"></i> Gastos
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="presupuestos">
                        <i class="bi bi-calculator me-2"></i> Presupuestos
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="cierres">
                        <i class="bi bi-journal-check me-2"></i> Cierres
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="anuncios">
                        <i class="bi bi-megaphone me-2"></i> Anuncios
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="solicitudes">
                        <i class="bi bi-envelope-paper me-2"></i> Solicitudes
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white" data-section="configuracion">
                        <i class="bi bi-gear me-2"></i> Configuración
                    </a>
                </li>
                <li id="permisosMenuItem">
                    <a href="#" class="nav-link text-white" data-section="permisos">
                        <i class="bi bi-shield-lock me-2"></i> Gestión de Permisos
                    </a>
                </li>
            </ul>

            <div class="sidebar-footer p-3">
                <button id="btnLogout" class="btn btn-outline-light btn-sm w-100">
                    <i class="bi bi-box-arrow-right me-2"></i> Cerrar Sesión
                </button>
            </div>
        </nav>

        <!-- Page Content -->
        <div id="content" class="bg-light">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-outline-dark">
                        <i class="bi bi-list"></i>
                    </button>
                    
                    <div class="ms-2">
                        <h5 class="mb-0" id="sectionTitle">Dashboard</h5>
                    </div>

                    <div class="ms-auto d-flex align-items-center">
                        <div class="dropdown">
                            <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-person-circle fs-4 me-2"></i>
                                <span id="userName">Administrador</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" href="#" data-section="perfil"><i class="bi bi-person me-2"></i> Mi Perfil</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="btnLogoutDropdown"><i class="bi bi-box-arrow-right me-2"></i> Cerrar Sesión</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Main Content -->
            <div class="container-fluid p-4">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="content-section active">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Fondo Ahorro</h6>
                                            <h4 class="mb-0" id="fondoAhorro">$67,500</h4>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-piggy-bank text-primary fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Gastos Mayores</h6>
                                            <h4 class="mb-0" id="fondoGastosMayores">$125,000</h4>
                                        </div>
                                        <div class="bg-success bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-building text-success fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Dinero Operacional</h6>
                                            <h4 class="mb-0" id="dineroOperacional">$48,000</h4>
                                        </div>
                                        <div class="bg-info bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-cash-stack text-info fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Patrimonio Total</h6>
                                            <h4 class="mb-0" id="patrimonioTotal">$240,500</h4>
                                        </div>
                                        <div class="bg-warning bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-bank text-warning fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Estado de Cuotas</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="cuotasChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Proyectos Críticos 2026</h5>
                                </div>
                                <div class="card-body">
                                    <ul class="list-group list-group-flush" id="proyectosList">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="badge bg-danger me-2">URGENTE</span>
                                                Legitimidad Legal
                                            </div>
                                            <span class="fw-bold">$35,000</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="badge bg-warning me-2">ALTA</span>
                                                Irregularidades Eléctricas
                                            </div>
                                            <span class="fw-bold">$85,000</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="badge bg-info me-2">MEDIA</span>
                                                Bombas Base Inestable
                                            </div>
                                            <span class="fw-bold">$45,000</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="badge bg-warning me-2">ALTA</span>
                                                Estructura Castillos
                                            </div>
                                            <span class="fw-bold">$120,000</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Últimos Gastos</h5>
                                    <a href="#" class="btn btn-sm btn-outline-primary" data-section="gastos">Ver Todos</a>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Concepto</th>
                                                    <th>Categoría</th>
                                                    <th>Fecha</th>
                                                    <th>Monto</th>
                                                </tr>
                                            </thead>
                                            <tbody id="ultimosGastosList">
                                                <tr>
                                                    <td>Mantenimiento Elevador</td>
                                                    <td><span class="badge bg-secondary">Mantenimiento</span></td>
                                                    <td>25/10/2025</td>
                                                    <td class="fw-bold">$3,500</td>
                                                </tr>
                                                <tr>
                                                    <td>Servicio Limpieza</td>
                                                    <td><span class="badge bg-secondary">Limpieza</span></td>
                                                    <td>20/10/2025</td>
                                                    <td class="fw-bold">$2,800</td>
                                                </tr>
                                                <tr>
                                                    <td>Reparación Bomba Agua</td>
                                                    <td><span class="badge bg-secondary">Reparación</span></td>
                                                    <td>15/10/2025</td>
                                                    <td class="fw-bold">$4,200</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Anuncios Recientes</h5>
                                    <a href="#" class="btn btn-sm btn-outline-primary" data-section="anuncios">Ver Todos</a>
                                </div>
                                <div class="card-body">
                                    <div id="anunciosRecientesList">
                                        <div class="card mb-3 border-0 bg-light">
                                            <div class="card-body">
                                                <h6 class="card-title">Reunión de Condominio</h6>
                                                <p class="card-text small">Se convoca a reunión de condominio el día 15 de noviembre a las 19:00 hrs en el área común.</p>
                                                <p class="card-text"><small class="text-muted">Publicado: 28/10/2025</small></p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 border-0 bg-light">
                                            <div class="card-body">
                                                <h6 class="card-title">Mantenimiento Cisterna</h6>
                                                <p class="card-text small">Se realizará mantenimiento a la cisterna el día 5 de noviembre. Habrá corte de agua de 9:00 a 14:00 hrs.</p>
                                                <p class="card-text"><small class="text-muted">Publicado: 25/10/2025</small></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Usuarios Section -->
                <section id="usuariosSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Usuarios</h4>
                        <button class="btn btn-primary" id="btnNuevoUsuario">
                            <i class="bi bi-person-plus me-2"></i> Nuevo Usuario
                        </button>
                    </div>
                    
                    <!-- Filtros de usuarios -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroUsuarioRol" class="form-label">Rol</label>
                                        <select class="form-select" id="filtroUsuarioRol">
                                            <option value="">Todos</option>
                                            <option value="ADMIN">Administrador</option>
                                            <option value="COMITE">Comité</option>
                                            <option value="INQUILINO">Inquilino</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroUsuarioEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroUsuarioEstado">
                                            <option value="">Todos</option>
                                            <option value="true">Activo</option>
                                            <option value="false">Inactivo</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroUsuarioDepartamento" class="form-label">Departamento</label>
                                        <select class="form-select" id="filtroUsuarioDepartamento">
                                            <option value="">Todos</option>
                                            <!-- Opciones cargadas dinámicamente -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroUsuarioBusqueda" class="form-label">Búsqueda</label>
                                        <input type="text" class="form-control" id="filtroUsuarioBusqueda" placeholder="Nombre o email">
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosUsuarios">Limpiar</button>
                                <button class="btn btn-primary" id="btnFiltrarUsuarios">Filtrar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="usuariosTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Nombre</th>
                                            <th>Email</th>
                                            <th>Departamento</th>
                                            <th>Rol</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usuariosTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cuotas Section -->
                <section id="cuotasSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Cuotas</h4>
                        <button class="btn btn-primary" id="btnGenerarCuotas">
                            <i class="bi bi-plus-circle me-2"></i> Generar Cuotas
                        </button>
                    </div>
                    
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCuotaMes" class="form-label">Mes</label>
                                        <select class="form-select" id="filtroCuotaMes">
                                            <option value="">Todos</option>
                                            <option value="Enero">Enero</option>
                                            <option value="Febrero">Febrero</option>
                                            <option value="Marzo">Marzo</option>
                                            <option value="Abril">Abril</option>
                                            <option value="Mayo">Mayo</option>
                                            <option value="Junio">Junio</option>
                                            <option value="Julio">Julio</option>
                                            <option value="Agosto">Agosto</option>
                                            <option value="Septiembre">Septiembre</option>
                                            <option value="Octubre">Octubre</option>
                                            <option value="Noviembre" selected>Noviembre</option>
                                            <option value="Diciembre">Diciembre</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCuotaAnio" class="form-label">Año</label>
                                        <select class="form-select" id="filtroCuotaAnio">
                                            <option value="2025" selected>2025</option>
                                            <option value="2026">2026</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCuotaEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroCuotaEstado">
                                            <option value="">Todos</option>
                                            <option value="PENDIENTE">Pendiente</option>
                                            <option value="PAGADO">Pagado</option>
                                            <option value="VENCIDO">Vencido</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCuotaDepartamento" class="form-label">Departamento</label>
                                        <select class="form-select" id="filtroCuotaDepartamento">
                                            <option value="">Todos</option>
                                            <!-- Opciones cargadas dinámicamente -->
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosCuotas">Limpiar</button>
                                <button class="btn btn-primary" id="btnFiltrarCuotas">Filtrar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="cuotasTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Departamento</th>
                                            <th>Mes/Año</th>
                                            <th>Monto</th>
                                            <th>Vencimiento</th>
                                            <th>Estado</th>
                                            <th>Fecha Pago</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cuotasTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Gastos Section -->
                <section id="gastosSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Gastos</h4>
                        <button class="btn btn-primary" id="btnNuevoGasto">
                            <i class="bi bi-plus-circle me-2"></i> Nuevo Gasto
                        </button>
                    </div>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="gastosTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Concepto</th>
                                            <th>Categoría</th>
                                            <th>Proveedor</th>
                                            <th>Fecha</th>
                                            <th>Monto</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="gastosTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Presupuestos Section -->
                <section id="presupuestosSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Presupuestos</h4>
                        <button class="btn btn-primary" id="btnNuevoPresupuesto">
                            <i class="bi bi-plus-circle me-2"></i> Nuevo Presupuesto
                        </button>
                    </div>
                    
                    <!-- Resumen financiero -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Presupuestado</h6>
                                            <h4 class="mb-0 text-primary" id="totalPresupuestado">$0</h4>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-calculator text-primary fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Ejecutado</h6>
                                            <h4 class="mb-0 text-danger" id="totalEjecutado">$0</h4>
                                        </div>
                                        <div class="bg-danger bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-arrow-down-circle text-danger fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Disponible</h6>
                                            <h4 class="mb-0 text-success" id="totalDisponible">$0</h4>
                                        </div>
                                        <div class="bg-success bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-cash-stack text-success fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">% Ejecución</h6>
                                            <h4 class="mb-0" id="porcentajeEjecucionTotal">0%</h4>
                                        </div>
                                        <div class="bg-info bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-pie-chart text-info fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filtros de presupuestos -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="filtroPresupuestoAnio" class="form-label">Año</label>
                                        <select class="form-select" id="filtroPresupuestoAnio">
                                            <option value="">Todos</option>
                                            <option value="2025" selected>2025</option>
                                            <option value="2026">2026</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="filtroPresupuestoCategoria" class="form-label">Categoría</label>
                                        <select class="form-select" id="filtroPresupuestoCategoria">
                                            <option value="">Todas</option>
                                            <option value="Mantenimiento">Mantenimiento</option>
                                            <option value="Reparación">Reparación</option>
                                            <option value="Limpieza">Limpieza</option>
                                            <option value="Servicios">Servicios</option>
                                            <option value="Administrativo">Administrativo</option>
                                            <option value="Proyecto">Proyecto</option>
                                            <option value="Otro">Otro</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="filtroPresupuestoEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroPresupuestoEstado">
                                            <option value="">Todos</option>
                                            <option value="borrador">Borrador</option>
                                            <option value="aprobado">Aprobado</option>
                                            <option value="rechazado">Rechazado</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosPresupuestos">Limpiar</button>
                                <button class="btn btn-primary" id="btnFiltrarPresupuestos">Filtrar</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Alertas de presupuesto -->
                    <div id="alertasPresupuestoContainer" class="mb-4">
                        <!-- Alertas cargadas dinámicamente -->
                    </div>
                    
                    <!-- Gráficos de presupuesto -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Ejecución Presupuestaria</h5>
                                </div>
                                <div class="card-body d-flex justify-content-center align-items-center">
                                    <canvas id="presupuestoEjecucionChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Presupuesto por Categoría</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="presupuestoCategoriaChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de presupuestos -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="presupuestosTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Título</th>
                                            <th>Categoría</th>
                                            <th>Monto</th>
                                            <th>Ejecución</th>
                                            <th>Año</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="presupuestosTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cierres Section -->
                <section id="cierresSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Cierres Contables</h4>
                        <div>
                            <button class="btn btn-primary me-2" id="btnGenerarCierreMensual">
                                <i class="bi bi-calendar-month me-2"></i> Cierre Mensual
                            </button>
                            <button class="btn btn-success" id="btnGenerarCierreAnual">
                                <i class="bi bi-calendar-check me-2"></i> Cierre Anual
                            </button>
                        </div>
                    </div>
                    
                    <!-- Resumen financiero actual -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Ingresos del Mes</h6>
                                            <h4 class="mb-0 text-success" id="ingresosMesActual">$0</h4>
                                        </div>
                                        <div class="bg-success bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-arrow-up-circle text-success fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Egresos del Mes</h6>
                                            <h4 class="mb-0 text-danger" id="egresosMesActual">$0</h4>
                                        </div>
                                        <div class="bg-danger bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-arrow-down-circle text-danger fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Balance del Mes</h6>
                                            <h4 class="mb-0 text-info" id="balanceMesActual">$0</h4>
                                        </div>
                                        <div class="bg-info bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-calculator text-info fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Cierres</h6>
                                            <h4 class="mb-0" id="totalCierres">0</h4>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-journal-check text-primary fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filtros de cierres -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCierreTipo" class="form-label">Tipo</label>
                                        <select class="form-select" id="filtroCierreTipo">
                                            <option value="">Todos</option>
                                            <option value="mensual">Mensual</option>
                                            <option value="anual">Anual</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCierreAño" class="form-label">Año</label>
                                        <select class="form-select" id="filtroCierreAño">
                                            <option value="">Todos</option>
                                            <option value="2025">2025</option>
                                            <option value="2026">2026</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroCierreMes" class="form-label">Mes</label>
                                        <select class="form-select" id="filtroCierreMes">
                                            <option value="">Todos</option>
                                            <option value="Enero">Enero</option>
                                            <option value="Febrero">Febrero</option>
                                            <option value="Marzo">Marzo</option>
                                            <option value="Abril">Abril</option>
                                            <option value="Mayo">Mayo</option>
                                            <option value="Junio">Junio</option>
                                            <option value="Julio">Julio</option>
                                            <option value="Agosto">Agosto</option>
                                            <option value="Septiembre">Septiembre</option>
                                            <option value="Octubre">Octubre</option>
                                            <option value="Noviembre">Noviembre</option>
                                            <option value="Diciembre">Diciembre</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <div class="mb-3 w-100">
                                        <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosCierres">Limpiar</button>
                                        <button class="btn btn-primary" id="btnFiltrarCierres">Filtrar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráfico de ingresos vs egresos -->
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Ingresos vs Egresos (Últimos 6 meses)</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="cierresChart" height="80"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de cierres -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="cierresTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Tipo</th>
                                            <th>Período</th>
                                            <th>Ingresos</th>
                                            <th>Egresos</th>
                                            <th>Balance</th>
                                            <th>Fecha</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cierresTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Anuncios Section -->
                <section id="anunciosSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Anuncios</h4>
                        <button class="btn btn-primary" id="btnNuevoAnuncio">
                            <i class="bi bi-megaphone me-2"></i> Nuevo Anuncio
                        </button>
                    </div>
                    
                    <!-- Estadísticas de anuncios -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Anuncios</h6>
                                            <h4 class="mb-0" id="totalAnuncios">0</h4>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-megaphone text-primary fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Anuncios Activos</h6>
                                            <h4 class="mb-0" id="anunciosActivos">0</h4>
                                        </div>
                                        <div class="bg-success bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-check-circle text-success fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Anuncios Urgentes</h6>
                                            <h4 class="mb-0" id="anunciosUrgentes">0</h4>
                                        </div>
                                        <div class="bg-danger bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-exclamation-triangle text-danger fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filtros de anuncios -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroAnuncioTipo" class="form-label">Tipo</label>
                                        <select class="form-select" id="filtroAnuncioTipo">
                                            <option value="">Todos</option>
                                            <option value="GENERAL">General</option>
                                            <option value="IMPORTANTE">Importante</option>
                                            <option value="URGENTE">Urgente</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroAnuncioEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroAnuncioEstado">
                                            <option value="">Todos</option>
                                            <option value="activo">Activo</option>
                                            <option value="inactivo">Inactivo</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="filtroAnuncioBusqueda" class="form-label">Búsqueda</label>
                                        <input type="text" class="form-control" id="filtroAnuncioBusqueda" placeholder="Buscar por título o contenido">
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosAnuncios">Limpiar</button>
                                <button class="btn btn-primary" id="btnFiltrarAnuncios">Filtrar</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de anuncios -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="anunciosTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Título</th>
                                            <th>Tipo</th>
                                            <th>Fecha Creación</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="anunciosTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Solicitudes Section -->
                <section id="solicitudesSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Solicitudes</h4>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" id="btnActualizarSolicitudes">
                                <i class="bi bi-arrow-clockwise me-2"></i> Actualizar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Estadísticas de solicitudes -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Total Solicitudes</h6>
                                            <h4 class="mb-0" id="totalSolicitudes">0</h4>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-envelope-paper text-primary fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Pendientes</h6>
                                            <h4 class="mb-0" id="solicitudesPendientes">0</h4>
                                        </div>
                                        <div class="bg-warning bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-clock text-warning fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">En Proceso</h6>
                                            <h4 class="mb-0" id="solicitudesEnProceso">0</h4>
                                        </div>
                                        <div class="bg-info bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-gear text-info fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-muted mb-2">Completadas</h6>
                                            <h4 class="mb-0" id="solicitudesCompletadas">0</h4>
                                        </div>
                                        <div class="bg-success bg-opacity-10 p-3 rounded">
                                            <i class="bi bi-check-circle text-success fs-3"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filtros de solicitudes -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Filtros</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroSolicitudEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroSolicitudEstado">
                                            <option value="">Todos</option>
                                            <option value="pendiente">Pendiente</option>
                                            <option value="en_proceso">En Proceso</option>
                                            <option value="completada">Completada</option>
                                            <option value="rechazada">Rechazada</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="mb-3">
                                        <label for="filtroSolicitudCategoria" class="form-label">Categoría</label>
                                        <select class="form-select" id="filtroSolicitudCategoria">
                                            <option value="">Todas</option>
                                            <option value="mantenimiento">Mantenimiento</option>
                                            <option value="seguridad">Seguridad</option>
                                            <option value="limpieza">Limpieza</option>
                                            <option value="administracion">Administración</option>
                                            <option value="general">General</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="filtroSolicitudBusqueda" class="form-label">Búsqueda</label>
                                        <input type="text" class="form-control" id="filtroSolicitudBusqueda" placeholder="Buscar por título o descripción">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de solicitudes -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Lista de Solicitudes</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ID</th>
                                            <th>Título</th>
                                            <th>Usuario</th>
                                            <th>Categoría</th>
                                            <th>Estado</th>
                                            <th>Fecha</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaSolicitudes">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Configuración Section -->
                <section id="configuracionSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h4 class="mb-1">Configuración del Sistema</h4>
                            <p class="text-muted mb-0 small">
                                <i class="bi bi-info-circle me-1"></i> Gestione usuarios y permisos del sistema
                            </p>
                        </div>
                        <span class="badge bg-primary py-2 px-3">
                            <i class="bi bi-shield-lock me-1"></i> Solo Administradores
                        </span>
                    </div>
                    
                    <!-- Contenedor de alertas para toda la sección -->
                    <div id="configAlertContainer" class="mb-4"></div>
                    
                    <!-- Tabs de Configuración -->
                    <ul class="nav nav-tabs config-tabs mb-4" id="configTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="usuarios-tab" data-bs-toggle="tab" data-bs-target="#usuarios-tab-pane" type="button" role="tab" aria-controls="usuarios-tab-pane" aria-selected="true">
                                <i class="bi bi-people me-2"></i> Gestión de Usuarios
                                <span class="d-block small text-muted mt-1">Crear, editar y gestionar usuarios</span>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="permisos-tab" data-bs-toggle="tab" data-bs-target="#permisos-tab-pane" type="button" role="tab" aria-controls="permisos-tab-pane" aria-selected="false">
                                <i class="bi bi-shield-lock me-2"></i> Gestión de Permisos
                                <span class="d-block small text-muted mt-1">Asignar y modificar permisos de acceso</span>
                            </button>
                        </li>
                        <li class="nav-item ms-auto" role="presentation">
                            <a href="#" class="nav-link text-muted" data-bs-toggle="modal" data-bs-target="#helpConfigModal">
                                <i class="bi bi-question-circle me-2"></i> Ayuda
                            </a>
                        </li>
                    </ul>
                    
                    <!-- Contenido de los Tabs -->
                    <div class="tab-content" id="configTabContent">
                        <!-- Tab de Usuarios -->
                        <div class="tab-pane fade show active animate-fade-in" id="usuarios-tab-pane" role="tabpanel" aria-labelledby="usuarios-tab" tabindex="0">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="mb-0">Gestión de Usuarios</h5>
                                <div>
                                    <button class="btn btn-outline-primary me-2" id="btnExportarUsuarios" data-bs-toggle="tooltip" data-bs-title="Exportar usuarios a Excel">
                                        <i class="bi bi-file-earmark-excel me-1"></i> Exportar
                                    </button>
                                    <button class="btn btn-primary" id="btnNuevoUsuarioConfig">
                                        <i class="bi bi-person-plus me-2"></i> Nuevo Usuario
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Filtros de usuarios -->
                            <div class="card border-0 shadow-sm mb-4">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h6 class="card-title mb-0">
                                        <i class="bi bi-funnel me-2"></i> Filtros de Búsqueda
                                    </h6>
                                    <button class="btn btn-sm btn-link text-muted p-0" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosCollapseConfig" aria-expanded="true" aria-controls="filtrosCollapseConfig">
                                        <i class="bi bi-chevron-up"></i>
                                    </button>
                                </div>
                                <div class="card-body collapse show" id="filtrosCollapseConfig">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label for="filtroUsuarioRolConfig" class="form-label">Rol</label>
                                                <select class="form-select" id="filtroUsuarioRolConfig">
                                                    <option value="">Todos</option>
                                                    <option value="ADMIN">Administrador</option>
                                                    <option value="COMITE">Comité</option>
                                                    <option value="INQUILINO">Inquilino</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label for="filtroUsuarioEstadoConfig" class="form-label">Estado</label>
                                                <select class="form-select" id="filtroUsuarioEstadoConfig">
                                                    <option value="">Todos</option>
                                                    <option value="true">Activo</option>
                                                    <option value="false">Inactivo</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label for="filtroUsuarioDepartamentoConfig" class="form-label">Departamento</label>
                                                <select class="form-select" id="filtroUsuarioDepartamentoConfig">
                                                    <option value="">Todos</option>
                                                    <!-- Opciones cargadas dinámicamente -->
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label for="filtroUsuarioBusquedaConfig" class="form-label">Búsqueda</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="filtroUsuarioBusquedaConfig" placeholder="Nombre o email">
                                                    <button class="btn btn-outline-secondary" type="button" id="btnBusquedaRapidaConfig">
                                                        <i class="bi bi-search"></i>
                                                    </button>
                                                </div>
                                                <div class="form-text">Búsqueda en tiempo real (mínimo 3 caracteres)</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-end">
                                        <button class="btn btn-outline-secondary me-2" id="btnLimpiarFiltrosUsuariosConfig">
                                            <i class="bi bi-x-circle me-1"></i> Limpiar
                                        </button>
                                        <button class="btn btn-primary" id="btnFiltrarUsuariosConfig">
                                            <i class="bi bi-search me-1"></i> Filtrar
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabla de usuarios -->
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h6 class="card-title mb-0">
                                        <i class="bi bi-table me-2"></i> Usuarios del Sistema
                                    </h6>
                                    <div>
                                        <span class="badge bg-primary me-2" id="totalUsuariosBadge">0</span>
                                        <div class="dropdown d-inline-block">
                                            <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="bi bi-gear"></i>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                                                <li><a class="dropdown-item" href="#" id="btnRefreshUsuariosConfig"><i class="bi bi-arrow-clockwise me-2"></i>Actualizar datos</a></li>
                                                <li><a class="dropdown-item" href="#" id="btnToggleInactivosConfig"><i class="bi bi-eye-slash me-2"></i>Mostrar/Ocultar inactivos</a></li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li><a class="dropdown-item" href="#" id="btnExportarPDFUsuariosConfig"><i class="bi bi-file-pdf me-2"></i>Exportar a PDF</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle" id="usuariosTableConfig">
                                            <thead>
                                                <tr>
                                                    <th style="cursor: pointer;" data-sort="id" class="sortable-column">
                                                        ID <i class="bi bi-arrow-down-up"></i>
                                                    </th>
                                                    <th style="cursor: pointer;" data-sort="nombre" class="sortable-column">
                                                        Nombre <i class="bi bi-arrow-down-up"></i>
                                                    </th>
                                                    <th style="cursor: pointer;" data-sort="email" class="sortable-column">
                                                        Email <i class="bi bi-arrow-down-up"></i>
                                                    </th>
                                                    <th style="cursor: pointer;" data-sort="departamento" class="sortable-column">
                                                        Departamento <i class="bi bi-arrow-down-up"></i>
                                                    </th>
                                                    <th>Rol</th>
                                                    <th>Estado</th>
                                                    <th>Acciones</th>
                                                </tr>
                                            </thead>
                                            <tbody id="usuariosTableBodyConfig">
                                                <!-- Datos cargados dinámicamente -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="loadingUsuariosConfig" class="text-center py-4" style="display: none;">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Cargando usuarios...</p>
                                    </div>
                                    <div id="emptyUsuariosConfig" class="text-center py-4" style="display: none;">
                                        <i class="bi bi-person-x text-muted" style="font-size: 3rem;"></i>
                                        <p class="mt-2 text-muted">No se encontraron usuarios con los filtros actuales</p>
                                        <button class="btn btn-outline-primary btn-sm" id="btnClearFiltersEmpty">
                                            <i class="bi bi-eraser me-1"></i> Limpiar filtros
                                        </button>
                                    </div>
                                    
                                    <!-- Paginación -->
                                    <div class="d-flex justify-content-between align-items-center mt-4" id="paginationContainerConfig">
                                        <div class="text-muted small">
                                            Mostrando <span id="paginationInfoConfig">0-0 de 0</span> usuarios
                                        </div>
                                        <nav aria-label="Paginación de usuarios">
                                            <ul class="pagination pagination-sm mb-0" id="paginationUsuariosConfig">
                                                <!-- Paginación dinámica -->
                                            </ul>
                                        </nav>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tab de Permisos -->
                        <div class="tab-pane fade animate-fade-in" id="permisos-tab-pane" role="tabpanel" aria-labelledby="permisos-tab" tabindex="0">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h5 class="mb-0">Gestión de Permisos</h5>
                                    <p class="text-muted mb-0 small">Configure los permisos de acceso para usuarios del comité</p>
                                </div>
                                <button class="btn btn-outline-primary" id="btnMostrarTodosUsuariosConfig">
                                    <i class="bi bi-people me-2"></i> Mostrar Todos los Usuarios
                                </button>
                            </div>
                            
                            <div id="permisosAlertContainerConfig"></div>
                            
                            <!-- Tarjeta de información -->
                            <div class="alert alert-info d-flex" role="alert">
                                <div class="me-3">
                                    <i class="bi bi-info-circle-fill fs-4"></i>
                                </div>
                                <div>
                                    <h6 class="alert-heading">Sobre los Permisos</h6>
                                    <p class="mb-0">Los usuarios con rol <strong>ADMIN</strong> tienen acceso completo a todas las funciones del sistema. Los usuarios con rol <strong>COMITE</strong> pueden tener permisos específicos que usted puede configurar. Los <strong>INQUILINOS</strong> tienen acceso limitado al portal de inquilinos.</p>
                                </div>
                            </div>
                            
                            <!-- Búsqueda rápida de usuarios -->
                            <div class="card border-0 shadow-sm mb-4">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h6 class="card-title mb-0">
                                        <i class="bi bi-search me-2"></i> Búsqueda Rápida
                                    </h6>
                                    <button class="btn btn-sm btn-link text-muted p-0" type="button" data-bs-toggle="collapse" data-bs-target="#busquedaCollapseConfig" aria-expanded="true" aria-controls="busquedaCollapseConfig">
                                        <i class="bi bi-chevron-up"></i>
                                    </button>
                                </div>
                                <div class="card-body collapse show" id="busquedaCollapseConfig">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="busquedaRapidaPermisos" class="form-label">Buscar usuario</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                                    <input type="text" class="form-control" id="busquedaRapidaPermisos" placeholder="Nombre, email o departamento...">
                                                    <button class="btn btn-outline-secondary" type="button" id="btnLimpiarBusquedaRapida">
                                                        <i class="bi bi-x-lg"></i>
                                                    </button>
                                                </div>
                                                <div class="form-text">La búsqueda se realiza automáticamente al escribir</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="filtroPermisoEspecifico" class="form-label">Filtrar por permiso</label>
                                                <select class="form-select" id="filtroPermisoEspecifico" data-bs-toggle="tooltip" data-bs-title="Muestra solo usuarios que tienen este permiso específico">
                                                    <option value="">Todos los permisos</option>
                                                    <option value="anuncios">Anuncios</option>
                                                    <option value="gastos">Gastos</option>
                                                    <option value="presupuestos">Presupuestos</option>
                                                    <option value="cuotas">Cuotas</option>
                                                    <option value="usuarios">Usuarios</option>
                                                    <option value="cierres">Cierres</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-end">
                                        <div class="form-check me-3">
                                            <input class="form-check-input" type="checkbox" id="showOnlyActivePermisosCheck" checked>
                                            <label class="form-check-label" for="showOnlyActivePermisosCheck">
                                                Mostrar solo usuarios activos
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabla de usuarios con permisos -->
                            <div class="card border-0 shadow-sm mb-4">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h6 class="card-title mb-0 d-flex align-items-center">
                                        <i class="bi bi-shield-lock me-2"></i> Usuarios con Rol de Comité
                                        <span class="badge bg-info ms-2" id="totalUsuariosComite">0</span>
                                    </h6>
                                    <button class="btn btn-sm btn-outline-primary" id="btnRefreshPermisos">
                                        <i class="bi bi-arrow-clockwise"></i>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle">
                                            <thead>
                                                <tr>
                                                    <th>Nombre</th>
                                                    <th>Email</th>
                                                    <th>Departamento</th>
                                                    <th>Permisos</th>
                                                    <th>Acciones</th>
                                                </tr>
                                            </thead>
                                            <tbody id="permisosTableBodyConfig">
                                                <!-- Datos cargados dinámicamente -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="loadingPermisosConfig" class="text-center py-4" style="display: none;">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Cargando permisos...</p>
                                    </div>
                                    <div id="emptyPermisosConfig" class="text-center py-4" style="display: none;">
                                        <i class="bi bi-shield-x text-muted" style="font-size: 3rem;"></i>
                                        <p class="mt-2 text-muted">No se encontraron usuarios con rol de comité</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Historial de cambios -->
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h6 class="card-title mb-0">
                                        <i class="bi bi-clock-history me-2"></i> Historial de Cambios
                                    </h6>
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-secondary" id="btnRefreshHistorial">
                                            <i class="bi bi-arrow-clockwise"></i>
                                        </button>
                                        <button class="btn btn-outline-secondary" id="btnExportarHistorial" data-bs-toggle="tooltip" data-bs-title="Exportar historial">
                                            <i class="bi bi-download"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Fecha</th>
                                                    <th>Administrador</th>
                                                    <th>Usuario</th>
                                                    <th>Cambios</th>
                                                </tr>
                                            </thead>
                                            <tbody id="actividadTableBodyConfig">
                                                <!-- Datos cargados dinámicamente -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="loadingHistorialConfig" class="text-center py-4" style="display: none;">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Cargando historial...</p>
                                    </div>
                                    <div id="emptyHistorialConfig" class="text-center py-4" style="display: none;">
                                        <i class="bi bi-clock-history text-muted" style="font-size: 3rem;"></i>
                                        <p class="mt-2 text-muted">No hay registros de actividad</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Permisos Section -->
                <section id="permisosSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Gestión de Permisos</h4>
                        <button class="btn btn-outline-primary" id="btnMostrarTodosUsuarios">
                            <i class="bi bi-people me-2"></i> Mostrar Todos los Usuarios
                        </button>
                    </div>
                    
                    <div id="permisosAlertContainer"></div>
                    
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Usuarios con Rol de Comité</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Nombre</th>
                                            <th>Email</th>
                                            <th>Departamento</th>
                                            <th>Permisos</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="permisosTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0">Historial de Cambios</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Administrador</th>
                                            <th>Usuario</th>
                                            <th>Cambios</th>
                                        </tr>
                                    </thead>
                                    <tbody id="actividadTableBody">
                                        <!-- Datos cargados dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Perfil Section -->
                <section id="perfilSection" class="content-section">
                    <h4 class="mb-4">Mi Perfil</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Información Personal</h5>
                                </div>
                                <div class="card-body">
                                    <form id="perfilForm">
                                        <div class="mb-3">
                                            <label for="perfilNombre" class="form-label">Nombre Completo</label>
                                            <input type="text" class="form-control" id="perfilNombre" value="Administrador" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="perfilEmail" class="form-label">Correo Electrónico</label>
                                            <input type="email" class="form-control" id="perfilEmail" value="admin@edificio205.com" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="perfilRol" class="form-label">Rol</label>
                                            <input type="text" class="form-control" id="perfilRol" value="Administrador" readonly>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <h5 class="card-title mb-0">Cambiar Contraseña</h5>
                                </div>
                                <div class="card-body">
                                    <form id="cambiarPasswordForm">
                                        <div class="mb-3">
                                            <label for="passwordActual" class="form-label">Contraseña Actual</label>
                                            <input type="password" class="form-control" id="passwordActual" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="passwordNueva" class="form-label">Nueva Contraseña</label>
                                            <input type="password" class="form-control" id="passwordNueva" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="passwordConfirmar" class="form-label">Confirmar Contraseña</label>
                                            <input type="password" class="form-control" id="passwordConfirmar" required>
                                        </div>
                                        <div class="d-grid gap-2">
                                            <button type="submit" class="btn btn-primary">Cambiar Contraseña</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Modal Usuario -->
    <div class="modal fade" id="usuarioModal" tabindex="-1" aria-labelledby="usuarioModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="usuarioModalLabel">Nuevo Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="usuarioForm" class="needs-validation" novalidate>
                        <input type="hidden" id="usuarioId">
                        
                        <!-- Alerta para mensajes de validación -->
                        <div id="usuarioFormAlert" class="alert alert-danger d-none">
                            <i class="bi bi-exclamation-triangle-fill me-2"></i>
                            <span id="usuarioFormAlertMessage">Por favor corrija los errores en el formulario</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="usuarioNombre" class="form-label">Nombre Completo <span class="text-danger">*</span></label>
                                    <div class="input-group has-validation">
                                        <span class="input-group-text"><i class="bi bi-person"></i></span>
                                        <input type="text" class="form-control" id="usuarioNombre" required 
                                               data-bs-toggle="tooltip" data-bs-title="Ingrese el nombre completo del usuario"
                                               placeholder="Ej: Juan Pérez">
                                        <div class="invalid-feedback">
                                            El nombre es obligatorio y debe tener al menos 3 caracteres
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="usuarioEmail" class="form-label">Correo Electrónico <span class="text-danger">*</span></label>
                                    <div class="input-group has-validation">
                                        <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                                        <input type="email" class="form-control" id="usuarioEmail" required
                                               data-bs-toggle="tooltip" data-bs-title="Ingrese un correo electrónico válido"
                                               placeholder="Ej: usuario@edificio205.com">
                                        <div class="invalid-feedback">
                                            Ingrese un correo electrónico válido
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="usuarioPassword" class="form-label">Contraseña <span class="text-danger" id="passwordRequired">*</span></label>
                                    <div class="input-group has-validation">
                                        <span class="input-group-text"><i class="bi bi-key"></i></span>
                                        <input type="password" class="form-control" id="usuarioPassword" required
                                               data-bs-toggle="tooltip" data-bs-title="Mínimo 6 caracteres">
                                        <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                        <div class="invalid-feedback">
                                            La contraseña debe tener al menos 6 caracteres
                                        </div>
                                    </div>
                                    <small class="text-muted" id="passwordHelp">Dejar en blanco para mantener la contraseña actual (en caso de edición)</small>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="usuarioDepartamento" class="form-label">Departamento <span class="text-danger">*</span></label>
                                    <select class="form-select" id="usuarioDepartamento" required
                                            data-bs-toggle="tooltip" data-bs-title="Seleccione el departamento del usuario">
                                        <option value="">Seleccionar...</option>
                                        <optgroup label="Primer Piso">
                                            <option value="101">101</option>
                                            <option value="102">102</option>
                                            <option value="103">103</option>
                                            <option value="104">104</option>
                                        </optgroup>
                                        <optgroup label="Segundo Piso">
                                            <option value="201">201</option>
                                            <option value="202">202</option>
                                            <option value="203">203</option>
                                            <option value="204">204</option>
                                        </optgroup>
                                        <optgroup label="Tercer Piso">
                                            <option value="301">301</option>
                                            <option value="302">302</option>
                                            <option value="303">303</option>
                                            <option value="304">304</option>
                                        </optgroup>
                                        <optgroup label="Cuarto Piso">
                                            <option value="401">401</option>
                                            <option value="402">402</option>
                                            <option value="403">403</option>
                                            <option value="404">404</option>
                                        </optgroup>
                                        <optgroup label="Quinto Piso">
                                            <option value="501">501</option>
                                            <option value="502">502</option>
                                            <option value="503">503</option>
                                            <option value="504">504</option>
                                        </optgroup>
                                    </select>
                                    <div class="invalid-feedback">
                                        Seleccione un departamento
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="usuarioRol" class="form-label">Rol <span class="text-danger">*</span></label>
                                    <select class="form-select" id="usuarioRol" required
                                            data-bs-toggle="tooltip" data-bs-title="Seleccione el rol del usuario">
                                        <option value="INQUILINO">Inquilino</option>
                                        <option value="COMITE">Comité</option>
                                        <option value="ADMIN">Administrador</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Seleccione un rol
                                    </div>
                                    <div class="form-text mt-2">
                                        <i class="bi bi-info-circle me-1"></i> 
                                        <span id="rolDescription">Los inquilinos tienen acceso limitado al portal de inquilinos.</span>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="usuarioActivo" checked>
                                        <label class="form-check-label" for="usuarioActivo">Usuario Activo</label>
                                    </div>
                                    <div class="form-text">
                                        <i class="bi bi-info-circle me-1"></i> Los usuarios inactivos no pueden acceder al sistema
                                    </div>
                                </div>
                                
                                <!-- Sección de permisos (visible solo para rol COMITE) -->
                                <div class="mb-3" id="permisosSection" style="display: none;">
                                    <label class="form-label">Permisos <span class="text-danger">*</span></label>
                                    <div class="alert alert-info py-2">
                                        <small><i class="bi bi-info-circle me-1"></i> Seleccione al menos un permiso</small>
                                    </div>
                                    <div class="card border-0 bg-light">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-end mb-2">
                                                <button type="button" class="btn btn-sm btn-outline-primary me-2" id="btnSeleccionarTodos">
                                                    Seleccionar Todos
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-secondary" id="btnDeseleccionarTodos">
                                                    Deseleccionar Todos
                                                </button>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="permisoAnuncios">
                                                <label class="form-check-label" for="permisoAnuncios">
                                                    <i class="bi bi-megaphone me-1 text-primary"></i> Anuncios
                                                </label>
                                                <small class="d-block text-muted ms-4">Crear, editar y publicar anuncios</small>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="permisoGastos">
                                                <label class="form-check-label" for="permisoGastos">
                                                    <i class="bi bi-credit-card me-1 text-success"></i> Gastos
                                                </label>
                                                <small class="d-block text-muted ms-4">Registrar y gestionar gastos</small>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="permisoPresupuestos">
                                                <label class="form-check-label" for="permisoPresupuestos">
                                                    <i class="bi bi-calculator me-1 text-warning"></i> Presupuestos
                                                </label>
                                                <small class="d-block text-muted ms-4">Crear y gestionar presupuestos</small>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="permisoCuotas">
                                                <label class="form-check-label" for="permisoCuotas">
                                                    <i class="bi bi-cash-coin me-1 text-info"></i> Cuotas
                                                </label>
                                                <small class="d-block text-muted ms-4">Gestionar cuotas y pagos</small>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="permisoUsuarios">
                                                <label class="form-check-label" for="permisoUsuarios">
                                                    <i class="bi bi-people me-1 text-danger"></i> Usuarios
                                                </label>
                                                <small class="d-block text-muted ms-4">Gestionar usuarios (excepto administradores)</small>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="permisoCierres">
                                                <label class="form-check-label" for="permisoCierres">
                                                    <i class="bi bi-journal-check me-1 text-secondary"></i> Cierres
                                                </label>
                                                <small class="d-block text-muted ms-4">Realizar cierres contables</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="invalid-feedback" id="permisosInvalidFeedback">
                                        Debe seleccionar al menos un permiso
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarUsuario">
                        <i class="bi bi-save me-1"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Generar Cuotas -->
    <div class="modal fade" id="generarCuotasModal" tabindex="-1" aria-labelledby="generarCuotasModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="generarCuotasModalLabel">Generar Cuotas Mensuales</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="generarCuotasForm">
                        <div class="mb-3">
                            <label for="cuotaMes" class="form-label">Mes</label>
                            <select class="form-select" id="cuotaMes" required>
                                <option value="">Seleccionar...</option>
                                <option value="Enero">Enero</option>
                                <option value="Febrero">Febrero</option>
                                <option value="Marzo">Marzo</option>
                                <option value="Abril">Abril</option>
                                <option value="Mayo">Mayo</option>
                                <option value="Junio">Junio</option>
                                <option value="Julio">Julio</option>
                                <option value="Agosto">Agosto</option>
                                <option value="Septiembre">Septiembre</option>
                                <option value="Octubre">Octubre</option>
                                <option value="Noviembre">Noviembre</option>
                                <option value="Diciembre">Diciembre</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cuotaAnio" class="form-label">Año</label>
                            <select class="form-select" id="cuotaAnio" required>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cuotaMonto" class="form-label">Monto (MXN)</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="cuotaMonto" value="550" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="cuotaFechaVencimiento" class="form-label">Fecha de Vencimiento</label>
                            <input type="date" class="form-control" id="cuotaFechaVencimiento" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarCuotas">Generar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Cuota -->
    <div class="modal fade" id="cuotaModal" tabindex="-1" aria-labelledby="cuotaModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cuotaModalLabel">Detalles de Cuota</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Departamento</label>
                        <input type="text" class="form-control" id="cuotaDetalleDepartamento" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Mes/Año</label>
                        <input type="text" class="form-control" id="cuotaDetalleMesAnio" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Monto</label>
                        <input type="text" class="form-control" id="cuotaDetalleMonto" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Fecha de Vencimiento</label>
                        <input type="text" class="form-control" id="cuotaDetalleFechaVencimiento" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Estado</label>
                        <select class="form-select" id="cuotaDetalleEstado">
                            <option value="PENDIENTE">Pendiente</option>
                            <option value="PAGADO">Pagado</option>
                            <option value="VENCIDO">Vencido</option>
                        </select>
                    </div>
                    <div class="mb-3" id="fechaPagoGroup">
                        <label class="form-label">Fecha de Pago</label>
                        <input type="date" class="form-control" id="cuotaDetalleFechaPago">
                    </div>
                    <div class="mb-3" id="comprobantePagoGroup">
                        <label class="form-label">Comprobante de Pago</label>
                        <input type="text" class="form-control" id="cuotaDetalleComprobantePago" placeholder="Referencia de pago">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarCuota">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Gasto -->
    <div class="modal fade" id="gastoModal" tabindex="-1" aria-labelledby="gastoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="gastoModalLabel">Nuevo Gasto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="gastoForm">
                        <input type="hidden" id="gastoId">
                        <div class="mb-3">
                            <label for="gastoConcepto" class="form-label">Concepto</label>
                            <input type="text" class="form-control" id="gastoConcepto" required>
                        </div>
                        <div class="mb-3">
                            <label for="gastoCategoria" class="form-label">Categoría</label>
                            <select class="form-select" id="gastoCategoria" required>
                                <option value="">Seleccionar...</option>
                                <option value="Mantenimiento">Mantenimiento</option>
                                <option value="Reparación">Reparación</option>
                                <option value="Limpieza">Limpieza</option>
                                <option value="Servicios">Servicios</option>
                                <option value="Administrativo">Administrativo</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="gastoProveedor" class="form-label">Proveedor</label>
                            <input type="text" class="form-control" id="gastoProveedor" required>
                        </div>
                        <div class="mb-3">
                            <label for="gastoFecha" class="form-label">Fecha</label>
                            <input type="date" class="form-control" id="gastoFecha" required>
                        </div>
                        <div class="mb-3">
                            <label for="gastoMonto" class="form-label">Monto (MXN)</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="gastoMonto" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="gastoDescripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="gastoDescripcion" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarGasto">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Permisos -->
    <div class="modal fade" id="permisoModal" tabindex="-1" aria-labelledby="permisoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title" id="permisoModalLabel">
                        <i class="bi bi-shield-lock me-2"></i> Configurar Permisos
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="permisoUsuarioId">
                    
                    <!-- Alerta para mensajes -->
                    <div id="permisoModalAlert" class="alert alert-info d-none">
                        <i class="bi bi-info-circle-fill me-2"></i>
                        <span id="permisoModalAlertMessage"></span>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="bi bi-person-badge me-2"></i> Información del Usuario
                                    </h6>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="avatar-circle me-3 bg-primary text-white">
                                            <span id="permisoUsuarioInitials">--</span>
                                        </div>
                                        <div>
                                            <p id="permisoUsuarioNombre" class="mb-0 fw-bold fs-5">Nombre del Usuario</p>
                                            <p id="permisoUsuarioEmail" class="text-muted small mb-0">email@ejemplo.com</p>
                                            <span id="permisoUsuarioDepartamento" class="badge bg-secondary mt-1">Depto</span>
                                        </div>
                                    </div>
                                    <div class="alert alert-warning py-2 mb-0">
                                        <small><i class="bi bi-exclamation-triangle me-1"></i> Los cambios en permisos se aplican inmediatamente</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="bi bi-info-circle me-2"></i> Resumen de Permisos
                                    </h6>
                                    <div id="permisosResumen" class="mb-3">
                                        <div class="progress mb-2">
                                            <div class="progress-bar" id="permisosProgressBar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                        </div>
                                        <p class="text-muted small mb-0">
                                            <span id="permisosActivosCount">0</span> de 6 permisos activos
                                        </p>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="button" class="btn btn-sm btn-outline-primary" id="btnSeleccionarTodosPermisos">
                                            <i class="bi bi-check-all me-1"></i> Seleccionar Todos
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary" id="btnDeseleccionarTodosPermisos">
                                            <i class="bi bi-x-lg me-1"></i> Deseleccionar Todos
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <h6 class="d-flex align-items-center">
                            <i class="bi bi-shield-check me-2"></i> Permisos Disponibles
                            <span class="badge bg-primary ms-2" id="permisosActivosLabel">0/6</span>
                        </h6>
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoAnuncios" data-permission="anuncios">
                                                <label class="form-check-label" for="permisoAnuncios">
                                                    <i class="bi bi-megaphone me-1 text-primary"></i> Anuncios
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite crear, editar y eliminar anuncios</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Crear anuncios</span>
                                                    <span class="badge bg-light text-dark">Editar anuncios</span>
                                                    <span class="badge bg-light text-dark">Eliminar anuncios</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoGastos" data-permission="gastos">
                                                <label class="form-check-label" for="permisoGastos">
                                                    <i class="bi bi-credit-card me-1 text-success"></i> Gastos
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite registrar y gestionar gastos</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Registrar gastos</span>
                                                    <span class="badge bg-light text-dark">Editar gastos</span>
                                                    <span class="badge bg-light text-dark">Ver reportes</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoPresupuestos" data-permission="presupuestos">
                                                <label class="form-check-label" for="permisoPresupuestos">
                                                    <i class="bi bi-calculator me-1 text-warning"></i> Presupuestos
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite crear y gestionar presupuestos</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Crear presupuestos</span>
                                                    <span class="badge bg-light text-dark">Editar presupuestos</span>
                                                    <span class="badge bg-light text-dark">Ver reportes</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoCuotas" data-permission="cuotas">
                                                <label class="form-check-label" for="permisoCuotas">
                                                    <i class="bi bi-cash-coin me-1 text-info"></i> Cuotas
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite gestionar cuotas y pagos</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Generar cuotas</span>
                                                    <span class="badge bg-light text-dark">Registrar pagos</span>
                                                    <span class="badge bg-light text-dark">Ver reportes</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoUsuarios" data-permission="usuarios">
                                                <label class="form-check-label" for="permisoUsuarios">
                                                    <i class="bi bi-people me-1 text-danger"></i> Usuarios
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite gestionar usuarios (excepto administradores)</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Ver usuarios</span>
                                                    <span class="badge bg-light text-dark">Editar inquilinos</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="permission-card mb-3">
                                            <div class="form-check form-switch">
                                                <input class="form-check-input permission-toggle" type="checkbox" id="permisoCierres" data-permission="cierres">
                                                <label class="form-check-label" for="permisoCierres">
                                                    <i class="bi bi-journal-check me-1 text-secondary"></i> Cierres
                                                </label>
                                            </div>
                                            <div class="permission-details">
                                                <small class="text-muted d-block mb-2">Permite realizar cierres contables</small>
                                                <div class="permission-actions">
                                                    <span class="badge bg-light text-dark">Generar cierres</span>
                                                    <span class="badge bg-light text-dark">Ver reportes</span>
                                                    <span class="badge bg-light text-dark">Exportar datos</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Vista previa de cambios -->
                    <div id="cambiosPreviewContainer" class="mb-3 d-none">
                        <h6><i class="bi bi-eye me-2"></i> Vista Previa de Cambios</h6>
                        <div class="card border-0 bg-light">
                            <div class="card-body">
                                <table class="table table-sm mb-0">
                                    <thead>
                                        <tr>
                                            <th>Permiso</th>
                                            <th>Estado Actual</th>
                                            <th></th>
                                            <th>Nuevo Estado</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cambiosPreviewBody">
                                        <!-- Contenido dinámico -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="position: sticky; bottom: 0; background-color: white; z-index: 1050;">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-outline-primary" id="btnPreviewCambios">
                        <i class="bi bi-eye me-1"></i> Vista Previa
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGuardarPermisos">
                        <i class="bi bi-save me-1"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Anuncio -->
    <div class="modal fade" id="anuncioModal" tabindex="-1" aria-labelledby="anuncioModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="anuncioModalLabel">Nuevo Anuncio</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="anuncioForm">
                        <input type="hidden" id="anuncioId">
                        <div class="mb-3">
                            <label for="anuncioTitulo" class="form-label">Título <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="anuncioTitulo" required maxlength="100">
                            <small class="text-muted">Máximo 100 caracteres</small>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="anuncioTipo" class="form-label">Tipo <span class="text-danger">*</span></label>
                                <select class="form-select" id="anuncioTipo" required>
                                    <option value="">Seleccionar...</option>
                                    <option value="GENERAL">General</option>
                                    <option value="IMPORTANTE">Importante</option>
                                    <option value="URGENTE">Urgente</option>
                                    <option value="REUNION">Reunión</option>
                                    <option value="MANTENIMIENTO">Mantenimiento</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="anuncioPrioridad" class="form-label">Prioridad</label>
                                <select class="form-select" id="anuncioPrioridad">
                                    <option value="0">Normal</option>
                                    <option value="1">Destacado</option>
                                    <option value="2">Muy destacado</option>
                                </select>
                                <small class="text-muted">Determina la posición en la lista</small>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="anuncioContenido" class="form-label">Contenido <span class="text-danger">*</span></label>
                            <div class="border rounded mb-2 p-2 bg-light">
                                <div class="btn-toolbar mb-2" role="toolbar">
                                    <div class="btn-group me-2" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="bold">
                                            <i class="bi bi-type-bold"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="italic">
                                            <i class="bi bi-type-italic"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="underline">
                                            <i class="bi bi-type-underline"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group me-2" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="h2">
                                            <i class="bi bi-type-h2"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="h3">
                                            <i class="bi bi-type-h3"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary" data-format="list">
                                            <i class="bi bi-list-ul"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <textarea class="form-control" id="anuncioContenido" rows="6" required maxlength="1000"></textarea>
                            <small class="text-muted">Máximo 1000 caracteres. <span id="contadorCaracteres">0/1000</span></small>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="anuncioFechaFin" class="form-label">Fecha de Expiración (Opcional)</label>
                                <input type="date" class="form-control" id="anuncioFechaFin">
                                <small class="text-muted">Dejar vacío para anuncio permanente</small>
                            </div>
                            <div class="col-md-6">
                                <label for="anuncioFechaPublicacion" class="form-label">Fecha de Publicación (Opcional)</label>
                                <input type="datetime-local" class="form-control" id="anuncioFechaPublicacion">
                                <small class="text-muted">Programar publicación futura</small>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="anuncioActivo" checked>
                                <label class="form-check-label" for="anuncioActivo">
                                    Publicar inmediatamente
                                </label>
                                <small class="text-muted d-block">Si se desmarca, el anuncio quedará guardado como borrador</small>
                            </div>
                        </div>
                        
                        <!-- Sección de Archivos Adjuntos -->
                        <div class="mb-3">
                            <label class="form-label">Archivos Adjuntos (Opcional)</label>
                            <div class="file-upload-area border rounded p-3" id="fileUploadArea">
                                <div class="text-center" id="uploadPlaceholder">
                                    <i class="bi bi-cloud-upload fs-1 text-muted mb-2"></i>
                                    <p class="mb-2">Arrastra archivos aquí o <button type="button" class="btn btn-link p-0" id="selectFilesBtn">selecciona archivos</button></p>
                                    <small class="text-muted">Máximo 5 archivos, 5MB cada uno. Formatos: PDF, DOC, DOCX, JPG, PNG, GIF, WEBP</small>
                                </div>
                                <input type="file" id="anuncioArchivos" name="archivos" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.webp" style="display: none;">
                                
                                <!-- Lista de archivos seleccionados -->
                                <div id="selectedFilesList" class="mt-3" style="display: none;">
                                    <h6 class="mb-2">Archivos seleccionados:</h6>
                                    <div id="filesContainer"></div>
                                </div>
                                
                                <!-- Archivos existentes (para edición) -->
                                <div id="existingFilesSection" class="existing-files-section" style="display: none;">
                                    <h6 class="mb-2">Archivos actuales:</h6>
                                    <div id="existingFilesContainer"></div>
                                </div>
                            </div>
                        </div>                        
                        <div class="mb-3">
                            <label class="form-label">Vista previa</label>
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0" id="previewTitulo">Título del anuncio</h6>
                                    <span class="badge bg-secondary" id="previewTipo">General</span>
                                </div>
                                <div class="card-body">
                                    <div id="previewContenido">Contenido del anuncio...</div>
                                    <p class="card-text mt-3">
                                        <small class="text-muted" id="previewFecha">Publicado: 30/10/2025</small>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarAnuncio">
                        <i class="bi bi-save me-2"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalle Anuncio -->
    <div class="modal fade" id="detalleAnuncioModal" tabindex="-1" aria-labelledby="detalleAnuncioModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detalleAnuncioModalLabel">Detalle del Anuncio</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="detalleAnuncioContenido">
                    <!-- Contenido cargado dinámicamente -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Generar Cierre Mensual -->
    <div class="modal fade" id="cierreMensualModal" tabindex="-1" aria-labelledby="cierreMensualModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cierreMensualModalLabel">Generar Cierre Mensual</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="cierreMensualForm">
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle me-2"></i>
                            El cierre mensual calculará automáticamente los ingresos y egresos del período seleccionado.
                        </div>
                        <div class="mb-3">
                            <label for="cierreMensualMes" class="form-label">Mes <span class="text-danger">*</span></label>
                            <select class="form-select" id="cierreMensualMes" required>
                                <option value="">Seleccionar...</option>
                                <option value="Enero">Enero</option>
                                <option value="Febrero">Febrero</option>
                                <option value="Marzo">Marzo</option>
                                <option value="Abril">Abril</option>
                                <option value="Mayo">Mayo</option>
                                <option value="Junio">Junio</option>
                                <option value="Julio">Julio</option>
                                <option value="Agosto">Agosto</option>
                                <option value="Septiembre">Septiembre</option>
                                <option value="Octubre">Octubre</option>
                                <option value="Noviembre">Noviembre</option>
                                <option value="Diciembre">Diciembre</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cierreMensualAño" class="form-label">Año <span class="text-danger">*</span></label>
                            <select class="form-select" id="cierreMensualAño" required>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cierreMensualObservaciones" class="form-label">Observaciones (Opcional)</label>
                            <textarea class="form-control" id="cierreMensualObservaciones" rows="3" placeholder="Notas adicionales sobre este cierre..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGenerarCierreMensualConfirmar">
                        <i class="bi bi-check-circle me-2"></i> Generar Cierre
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Generar Cierre Anual -->
    <div class="modal fade" id="cierreAnualModal" tabindex="-1" aria-labelledby="cierreAnualModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cierreAnualModalLabel">Generar Cierre Anual</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="cierreAnualForm">
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <strong>Importante:</strong> El cierre anual consolidará todos los cierres mensuales del año seleccionado.
                        </div>
                        <div class="mb-3">
                            <label for="cierreAnualAño" class="form-label">Año <span class="text-danger">*</span></label>
                            <select class="form-select" id="cierreAnualAño" required>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cierreAnualObservaciones" class="form-label">Observaciones (Opcional)</label>
                            <textarea class="form-control" id="cierreAnualObservaciones" rows="3" placeholder="Notas adicionales sobre este cierre anual..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="btnGenerarCierreAnualConfirmar">
                        <i class="bi bi-check-circle me-2"></i> Generar Cierre Anual
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalle Cierre -->
    <div class="modal fade" id="detalleCierreModal" tabindex="-1" aria-labelledby="detalleCierreModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detalleCierreModalLabel">Detalle del Cierre</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="detalleCierreContenido">
                    <!-- Contenido cargado dinámicamente -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="btnExportarCierre">
                        <i class="bi bi-download me-2"></i> Exportar PDF
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Opciones de Exportación -->
    <div class="modal fade" id="exportOptionsModal" tabindex="-1" aria-labelledby="exportOptionsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exportOptionsModalLabel">Opciones de Exportación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="exportOptionsForm">
                        <div class="mb-3">
                            <label class="form-label">Formato</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="formato" id="formatoPDF" value="pdf" checked>
                                <label class="form-check-label" for="formatoPDF">
                                    PDF
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="formato" id="formatoExcel" value="excel">
                                <label class="form-check-label" for="formatoExcel">
                                    Excel
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Contenido</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="incluirResumen" checked>
                                <label class="form-check-label" for="incluirResumen">
                                    Incluir resumen financiero
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="incluirDetalleIngresos" checked>
                                <label class="form-check-label" for="incluirDetalleIngresos">
                                    Incluir detalle de ingresos
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="incluirDetalleEgresos" checked>
                                <label class="form-check-label" for="incluirDetalleEgresos">
                                    Incluir detalle de egresos
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="incluirGraficos" checked>
                                <label class="form-check-label" for="incluirGraficos">
                                    Incluir gráficos
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="incluirIndicadores" checked>
                                <label class="form-check-label" for="incluirIndicadores">
                                    Incluir indicadores financieros
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="tituloPersonalizado" class="form-label">Título personalizado (opcional)</label>
                            <input type="text" class="form-control" id="tituloPersonalizado" placeholder="Ej: Cierre Mensual - Noviembre 2025">
                        </div>
                        
                        <div class="mb-3">
                            <label for="notasAdicionales" class="form-label">Notas adicionales (opcional)</label>
                            <textarea class="form-control" id="notasAdicionales" rows="3" placeholder="Notas o comentarios adicionales para incluir en el reporte..."></textarea>
                        </div>
                        
                        <input type="hidden" id="exportCierreId" value="">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnConfirmarExport">Exportar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Ayuda Configuración -->
    <div class="modal fade" id="helpConfigModal" tabindex="-1" aria-labelledby="helpConfigModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title" id="helpConfigModalLabel">
                        <i class="bi bi-question-circle me-2"></i> Ayuda - Configuración del Sistema
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-0 bg-light mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="bi bi-people me-2 text-primary"></i> Gestión de Usuarios
                                    </h5>
                                    <p class="card-text">Esta sección le permite administrar los usuarios del sistema:</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-person-plus me-2 text-success"></i> <strong>Crear usuarios</strong>: Añada nuevos usuarios al sistema
                                        </li>
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-pencil me-2 text-primary"></i> <strong>Editar usuarios</strong>: Modifique información de usuarios existentes
                                        </li>
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-toggle-on me-2 text-warning"></i> <strong>Activar/Desactivar</strong>: Controle el acceso de los usuarios
                                        </li>
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-search me-2 text-info"></i> <strong>Filtrar</strong>: Busque usuarios específicos
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 bg-light mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <i class="bi bi-shield-lock me-2 text-primary"></i> Gestión de Permisos
                                    </h5>
                                    <p class="card-text">Esta sección le permite configurar los permisos de acceso:</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-shield-check me-2 text-success"></i> <strong>Asignar permisos</strong>: Configure qué puede hacer cada usuario
                                        </li>
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-clock-history me-2 text-primary"></i> <strong>Historial</strong>: Vea los cambios realizados a los permisos
                                        </li>
                                        <li class="list-group-item bg-transparent">
                                            <i class="bi bi-filter me-2 text-warning"></i> <strong>Filtrar</strong>: Busque usuarios por permisos específicos
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <h6 class="alert-heading">
                            <i class="bi bi-info-circle me-2"></i> Roles del Sistema
                        </h6>
                        <p class="mb-0">El sistema tiene tres roles principales:</p>
                        <ul class="mb-0">
                            <li><strong>Administrador (ADMIN)</strong>: Acceso completo a todas las funciones del sistema.</li>
                            <li><strong>Comité (COMITE)</strong>: Acceso a funciones específicas según los permisos asignados.</li>
                            <li><strong>Inquilino (INQUILINO)</strong>: Acceso limitado al portal de inquilinos.</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-warning mt-3">
                        <h6 class="alert-heading">
                            <i class="bi bi-exclamation-triangle me-2"></i> Importante
                        </h6>
                        <p class="mb-0">Los cambios en usuarios y permisos afectan inmediatamente el acceso al sistema. Asegúrese de verificar cuidadosamente antes de guardar los cambios.</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Presupuesto -->
    <div class="modal fade" id="presupuestoModal" tabindex="-1" aria-labelledby="presupuestoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="presupuestoModalLabel">Nuevo Presupuesto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="presupuestoForm">
                        <input type="hidden" id="presupuestoId">
                        <div class="mb-3">
                            <label for="presupuestoTitulo" class="form-label">Título <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="presupuestoTitulo" required>
                        </div>
                        <div class="mb-3">
                            <label for="presupuestoMonto" class="form-label">Monto (MXN) <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="presupuestoMonto" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="presupuestoCategoria" class="form-label">Categoría <span class="text-danger">*</span></label>
                            <select class="form-select" id="presupuestoCategoria" required>
                                <option value="">Seleccionar...</option>
                                <option value="Mantenimiento">Mantenimiento</option>
                                <option value="Reparación">Reparación</option>
                                <option value="Limpieza">Limpieza</option>
                                <option value="Servicios">Servicios</option>
                                <option value="Administrativo">Administrativo</option>
                                <option value="Proyecto">Proyecto</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="presupuestoAnio" class="form-label">Año <span class="text-danger">*</span></label>
                            <select class="form-select" id="presupuestoAnio" required>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="presupuestoDescripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="presupuestoDescripcion" rows="3"></textarea>
                        </div>
                        <div class="mb-3" id="presupuestoEstadoGroup" style="display: none;">
                            <label for="presupuestoEstado" class="form-label">Estado</label>
                            <select class="form-select" id="presupuestoEstado">
                                <option value="borrador">Borrador</option>
                                <option value="aprobado">Aprobado</option>
                                <option value="rechazado">Rechazado</option>
                            </select>
                        </div>
                        <div class="mb-3" id="presupuestoMontoEjecutadoGroup" style="display: none;">
                            <label for="presupuestoMontoEjecutado" class="form-label">Monto Ejecutado (MXN)</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="presupuestoMontoEjecutado" value="0">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarPresupuesto">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalle Presupuesto -->
    <div class="modal fade" id="detallePresupuestoModal" tabindex="-1" aria-labelledby="detallePresupuestoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detallePresupuestoModalLabel">Detalle del Presupuesto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="detallePresupuestoContenido">
                    <!-- Contenido cargado dinámicamente -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="btnExportarPresupuesto">
                        <i class="bi bi-download me-2"></i> Exportar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Solicitud -->
    <div class="modal fade" id="modalSolicitud" tabindex="-1" aria-labelledby="modalSolicitudLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalSolicitudLabel">Detalles de Solicitud</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">ID:</label>
                                <span id="solicitudId" class="form-control-plaintext">-</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Estado:</label>
                                <select class="form-select" id="solicitudEstado">
                                    <option value="pendiente">Pendiente</option>
                                    <option value="en_proceso">En Proceso</option>
                                    <option value="completada">Completada</option>
                                    <option value="rechazada">Rechazada</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Usuario:</label>
                                <span id="solicitudUsuario" class="form-control-plaintext">-</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label fw-bold">Categoría:</label>
                                <span id="solicitudCategoria" class="form-control-plaintext">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Título:</label>
                        <span id="solicitudTitulo" class="form-control-plaintext">-</span>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Descripción:</label>
                        <div id="solicitudDescripcion" class="form-control-plaintext border p-3 bg-light rounded">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Fecha de Creación:</label>
                        <span id="solicitudFecha" class="form-control-plaintext">-</span>
                    </div>
                    <div class="mb-3">
                        <label for="solicitudRespuesta" class="form-label fw-bold">Respuesta del Administrador:</label>
                        <textarea class="form-control" id="solicitudRespuesta" rows="4" placeholder="Escriba su respuesta aquí..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-danger" id="btnEliminarSolicitud">
                        <i class="bi bi-trash me-2"></i> Eliminar
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGuardarSolicitud">
                        <i class="bi bi-check-lg me-2"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/dashboard.js"></script>
    <script src="/js/usuarios.js"></script>
    <script src="/js/cuotas.js"></script>
<script src="/js/file-upload.js"></script>
    <script src="/js/gastos.js"></script>
    <script src="/js/permisos.js"></script>
    <script src="/js/anuncios.js"></script>
    <script src="/js/solicitudes.js"></script>
    <script src="/js/cierres.js"></script>
    <script src="/js/presupuestos.js"></script>
    <script src="/js/configuracion.js"></script>
    <script src="/js/anuncios-init.js"></script>
    <script src="/js/cierres-init.js"></script>
    <script src="/js/test-api.js"></script>
    <script src="/js/modal-handlers.js"></script>
    <script src="/js/main-controller.js"></script>
</body>
</html>